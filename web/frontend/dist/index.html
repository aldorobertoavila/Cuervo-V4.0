<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Cuervo V4.0</title>

  <script src="https://code.highcharts.com/stock/highstock.js"></script>
  <script src="https://code.highcharts.com/highcharts-more.js"></script>
  <script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
  <script src="https://code.highcharts.com/stock/modules/export-data.js"></script>
  <script src="https://code.highcharts.com/modules/accessibility.js"></script>

  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-functions-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-messaging-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-storage-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-remote-config-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-performance-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/init.js?useEmulator=true"></script>

  <link rel="icon" href="images/favicon.png" sizes="32x32">

  <link rel="stylesheet" type="text/css" href="styles/components/card.css">
  <link rel="stylesheet" type="text/css" href="styles/components/collapsible.css">
  <link rel="stylesheet" type="text/css" href="styles/components/linechart.css">
  <link rel="stylesheet" type="text/css" href="styles/components/number-block.css">
  <link rel="stylesheet" type="text/css" href="styles/components/page.css">
  <link rel="stylesheet" type="text/css" href="styles/media-queries.css">
</head>

<body class="page">
  <header class="page-header page-header--main-header">
    <nav class="page-navbar">
      <div class="page-navbar__header">
        <!-- <a href="#" class="page-navbar__logo"><img src="images/logo.png" alt="Logo"></a> -->
        <h1 class="page-navbar__title">Cuervo V4.0</h1>
      </div>
      <div class="page-navbar__items">
        <!-- <a href="#" class="page-navbar__icon" role="button"><img src="images/account_circle.png" alt="Account Icon"></a>
        <a href="#" class="page-navbar__icon" role="button"><img src="images/logout.png" alt="Logout Icon"></a>
        <a href="#" class="page-navbar__icon" role="button"><img src="images/download.png" alt="Download Icon"></a>
        <a href="#" class="page-navbar__icon" role="button"><img src="images/settings.png" alt="Settings Icon"></a> -->
      </div>
    </nav>
  </header>

  <main class="page-content">
    <section class="page-section page-section--login">
      <!-- <a href="./dashboard.html"></a> -->
      <button id="signInButton">Create Account / Sign In</button>
      <button id="signOutButton">Sign Out</button>
    
      <div id="message">
        <p>You have signed in as <span id="userName"></span> with the email <span id="userEmail"></span> </p>
      </div>
    </section>
  </main>
  <footer class="page-footer">

  </footer>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js";

    const app = initializeApp(firebaseConfig);
    const auth = getAuth();
    const provider = new GoogleAuthProvider()

    const signInButton = document.getElementById("signInButton");
    const signOutButton = document.getElementById("signOutButton");
    const message = document.getElementById("message");
    const userName = document.getElementById("userName");
    const userEmail = document.getElementById("userEmail");

    signOutButton.style.display = "none";
    message.style.display = "none";

    const userSignIn = async () => {
      signInWithPopup(auth, provider)
        .then((result) => {
          const user = result.user
          console.log(user);
        }).catch((error) => {
          const errorCode = error.code;
          const errorMessage = error.message
        })
    }

    const userSignOut = async () => {
      signOut(auth).then(() => {
        alert("You have signed out successfully!");
      }).catch((error) => { })
    }

    onAuthStateChanged(auth, (user) => {
      if (user) {
        signOutButton.style.display = "block";
        message.style.display = "block";
        userName.innerHTML = user.displayName;
        userEmail.innerHTML = user.email
      } else {
        signOutButton.style.display = "none";
        message.style.display = "none";
      }
    })

    signInButton.addEventListener('click', userSignIn);
    signOutButton.addEventListener('click', userSignOut);
  </script>
</body>

</html>